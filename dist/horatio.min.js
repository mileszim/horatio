/*! horatio - v0.0.0 - 2014-04-22
* https://github.com/mileszim/horatio
* Copyright (c) 2014 ; Licensed  */
var Horatio=Horatio||{hasModule:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require};Horatio.hasModule&&(module.exports=Horatio),Horatio.Wordlists={},Horatio.Token=function(a,b){this.kind=a,this.sequence=b},Horatio.Token.CHARACTER=10,Horatio.Token.ARTICLE=11,Horatio.Token.BE=12,Horatio.Token.ACT=13,Horatio.Token.SCENE=14,Horatio.Token.ENTER=15,Horatio.Token.EXIT=16,Horatio.Token.EXEUNT=17,Horatio.Token.INPUT_INTEGER=21,Horatio.Token.INPUT_CHAR=22,Horatio.Token.OUTPUT_INTEGER=24,Horatio.Token.OUTPUT_CHAR=25,Horatio.Token.IMPERATIVE=30,Horatio.Token.TO=31,Horatio.Token.RETURN=32,Horatio.Token.POSITIVE_COMPARATIVE=40,Horatio.Token.NEGATIVE_COMPARATIVE=41,Horatio.Token.AS=42,Horatio.Token.NOT=43,Horatio.Token.THAN=44,Horatio.Token.IF_SO=45,Horatio.Token.BE_COMPARATIVE=46,Horatio.Token.UNARY_OPERATOR=50,Horatio.Token.ARITHMETIC_OPERATOR=51,Horatio.Token.REMEMBER=60,Horatio.Token.RECALL=61,Horatio.Token.FIRST_PERSON_PRONOUN=70,Horatio.Token.SECOND_PERSON_PRONOUN=71,Horatio.Token.POSITIVE_ADJECTIVE=72,Horatio.Token.NEUTRAL_ADJECTIVE=73,Horatio.Token.NEGATIVE_ADJECTIVE=74,Horatio.Token.POSITIVE_NOUN=75,Horatio.Token.NEUTRAL_NOUN=76,Horatio.Token.NEGATIVE_NOUN=77,Horatio.Token.ROMAN_NUMERAL=78,Horatio.Token.COLON=90,Horatio.Token.COMMA=91,Horatio.Token.PERIOD=92,Horatio.Token.EXCLAMATION_POINT=93,Horatio.Token.QUESTION_MARK=94,Horatio.Token.AMPERSAND=95,Horatio.Token.AND=96,Horatio.Token.LEFT_BRACKET=97,Horatio.Token.RIGHT_BRACKET=98,Horatio.Token.COMMENT=110,Horatio.Visitor=function(){},Horatio.Visitor.prototype={visitProgram:function(a){var b=this;if(a.comment.visit(this,null),!(a.declarations.length>0))throw new Error("Semantic Error - No characters declared.");if(a.declarations.forEach(function(a){a.visit(b,null)}),!(a.parts.length>0))throw new Error("Semantic Error - No parts in program.");return a.parts.forEach(function(a){a.visit(b,null)}),null},visitComment:function(a){if(a.sequence)return null;throw new Error("Semantic Error - Comment malformed.")},visitDeclaration:function(a,b){var c=a.character.visit(this,b);if(this.characters[c.sequence])throw new Error("Semantic Error - Character already defined.");return this.characters[c.sequence]={on_stage:!1,value_depth:0},a.comment.visit(this,b),null},visitCharacter:function(a,b){if(!a.sequence)throw new Error("Semantic Error - Character undefined.");if(!(a instanceof Horatio.AST.Character))throw new Error("Semantic Error - Not of type Character.");if(b&&b.declared===!0&&!this.declared(a.sequence))throw new Error("Semantic Error - Character Undeclared");if(b&&b.hasOwnProperty("on_stage"))switch(b.on_stage){case!0:if(!this.onStage(a.sequence))throw new Error("Semantic Error - Character not on stage.");break;case!1:if(this.onStage(a.sequence))throw new Error("Semantic Error - Character already on stage.")}return a},visitPart:function(a,b){var c=this;if(a.numeral.visit(this,b),a.comment.visit(this,b),!(a.subparts.length>0))throw new Error("Semantic Error - No subparts defined.");return a.subparts.forEach(function(a){a.visit(c,b)}),null},visitNumeral:function(a){if(a.sequence)return null;throw new Error("Semantic Error - Numeral malformed.")},visitSubpart:function(a,b){return a.numeral.visit(this,b),a.comment.visit(this,b),a.stage.visit(this,b),null},visitStage:function(a,b){return a.start_presence&&a.start_presence.visit(this,b),a.end_presence&&a.end_presence.visit(this,b),a.dialogue&&a.dialogue.visit(this,b),null},visitEnter:function(a){if(!a.character_1&&!a.character_2)throw new Error("Semantic Error - No characters entering.");var b=a.character_1.visit(this,{declared:!0,on_stage:!1});if(this.toggleStage(b.sequence),a.character_2){var c=a.character_2.visit(this,{declared:!0,on_stage:!1});if(b.sequence===c.sequence)throw new Error("Semantic Error - Same character entering twice in same statement.");this.toggleStage(c.sequence)}return null},visitExit:function(a){if(!a.character)throw new Error("Semantic Error - No character exiting.");var b=a.character.visit(this,{declared:!0,on_stage:!0});return this.toggleStage(b.sequence),null},visitExeunt:function(a){if(a.character_1?!a.character_2:a.character_2)throw new Error("Semantic Error - Either 2 or no characters can be defined, not one.");if(a.character_1&&a.character_2){var b=a.character_1.visit(this,{declared:!0,on_stage:!0}),c=a.character_2.visit(this,{declared:!0,on_stage:!0});if(b.sequence===c.sequence)throw new Error("Semantic Error - Characters are the same.");this.toggleStage(b.sequence),this.toggleStage(c.sequence)}else this.exeuntStage();return null},visitDialogue:function(a,b){var c=this;return a.lines.forEach(function(a){a.visit(c,b)}),null},visitLine:function(a,b){{var c=this;a.character.visit(this,{declared:!0,on_stage:!0})}if(0===a.sentences.length)throw new Error("Semantic Error - Line cannot have no sentences.");return a.sentences.forEach(function(a){a.visit(c,b)}),null}},Horatio.AST={Program:function(a,b,c){this.comment=a,this.declarations=b,this.parts=c,this.visit=function(a,b){return a.visitProgram(this,b)}},Declaration:function(a,b){this.character=a,this.comment=b,this.visit=function(a,b){return a.visitDeclaration(this,b)}},Part:function(a,b,c){this.numeral=a,this.comment=b,this.subparts=c,this.visit=function(a,b){return a.visitPart(this,b)}},Subpart:function(a,b,c){this.numeral=a,this.comment=b,this.stage=c,this.visit=function(a,b){return a.visitSubpart(this,b)}},Stage:function(a,b,c){this.dialogue=a,this.start_presence=b,this.end_presence=c,this.visit=function(a,b){return a.visitStage(this,b)}},Enter:function(a,b){this.character_1=a,this.character_2=b,this.visit=function(a,b){return a.visitEnter(this,b)}},Exit:function(a){this.character=a,this.visit=function(a,b){return a.visitExit(this,b)}},Exeunt:function(a,b){this.character_1=a,this.character_2=b,this.visit=function(a,b){return a.visitExeunt(this,b)}},Dialogue:function(a){this.lines=a,this.visit=function(a,b){return a.visitDialogue(this,b)}},Line:function(a,b){this.character=a,this.sentences=b,this.visit=function(a,b){return a.visitLine(this,b)}},Goto:function(a){this.numeral=a,this.visit=function(a,b){return a.visitGoto(this,b)}},AssignmentSentence:function(a){this.value=a,this.visit=function(a,b){return a.visitAssignmentSentence(this,b)}},QuestionSentence:function(a,b){this.comparison=a,this.value=b,this.visit=function(a,b){return a.visitQuestionSentence(this,b)}},ResponseSentence:function(a){this.goto=a,this.visit=function(a,b){return a.visitResponseSentence(this,b)}},GotoSentence:function(a){this.goto=a,this.visit=function(a,b){return a.visitGotoSentence(this,b)}},IntegerInputSentence:function(a){this.sequence=a,this.visit=function(a,b){return a.visitIntegerInputSentence(this,b)}},CharInputSentence:function(a){this.sequence=a,this.visit=function(a,b){return a.visitCharInputSentence(this,b)}},IntegerOutputSentence:function(a){this.sequence=a,this.visit=function(a,b){return a.visitIntegerOutputSentence(this,b)}},CharOutputSentence:function(a){this.sequence=a,this.visit=function(a,b){return a.visitCharOutputSentence(this,b)}},RememberSentence:function(a){this.pronoun=a,this.visit=function(a,b){return a.visitRememberSentence(this,b)}},RecallSentence:function(a){this.comment=a,this.visit=function(a,b){return a.visitRecallSentence(this,b)}},PositiveConstantValue:function(a,b){this.noun=a,this.adjectives=b,this.visit=function(a,b){return a.visitPositiveConstantValue(this,b)}},NegativeConstantValue:function(a,b){this.noun=a,this.adjectives=b,this.visit=function(a,b){return a.visitPositiveConstantValue(this,b)}},UnaryOperationValue:function(a,b){this.operator=a,this.value=b,this.visit=function(a,b){return a.visitPositiveConstantValue(this,b)}},ArithmeticOperationValue:function(a,b,c){this.operator=a,this.value_1=b,this.value_2=c,this.visit=function(a,b){return a.visitArithmeticOperationValue(this,b)}},PronounValue:function(a){this.pronoun=a,this.visit=function(a,b){return a.visitPronounValue(this,b)}},GreaterThanComparison:function(a){this.comparative=a,this.visit=function(a,b){return a.visitGreaterThanComparison(this,b)}},LesserThanComparison:function(a){this.comparative=a,this.visit=function(a,b){return a.visitLesserThanComparison(this,b)}},EqualToComparison:function(a){this.adjective=a,this.visit=function(a,b){return a.visitEqualToComparison(this,b)}},InverseComparison:function(a){this.comparison=a,this.visit=function(a,b){return a.visitInverseComparison(this,b)}},Comment:function(a){this.sequence=a,this.visit=function(a,b){return a.visitComment(this,b)}},Numeral:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNumeral(this,b)}},Character:function(a){this.sequence=a,this.visit=function(a,b){return a.visitCharacter(this,b)}},FirstPersonPronoun:function(a){this.sequence=a,this.visit=function(a,b){return a.visitFirstPersonPronoun(this,b)}},SecondPersonPronoun:function(a){this.sequence=a,this.visit=function(a,b){return a.visitSecondPersonPronoun(this,b)}},PositiveNoun:function(a){this.sequence=a,this.visit=function(a,b){return a.visitPositiveNoun(this,b)}},NeutralNoun:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNeutralNoun(this,b)}},NegativeNoun:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNegativeNoun(this,b)}},PositiveAdjective:function(a){this.sequence=a,this.visit=function(a,b){return a.visitPositiveAdjective(this,b)}},NeutralAdjective:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNeutralAdjective(this,b)}},NegativeAdjective:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNegativeAdjective(this,b)}},UnaryOperator:function(a){this.sequence=a,this.visit=function(a,b){return a.visitUnaryOperator(this,b)}},ArithmeticOperator:function(a){this.sequence=a,this.visit=function(a,b){return a.visitArithmeticOperator(this,b)}},PositiveComparative:function(a){this.sequence=a,this.visit=function(a,b){return a.visitPositiveComparative(this,b)}},NegativeComparative:function(a){this.sequence=a,this.visit=function(a,b){return a.visitNegativeComparative(this,b)}}},Horatio.Tokenizer=function(a){this.tokens=[],this.dictionary={},this.buildDictionary(),this.tokenize(a)},Horatio.Tokenizer.prototype={nextToken:function(){return this.tokens.length>0?this.tokens.shift():-1},tokenize:function(a){a=a.trim().replace(/[\s\n]+/g," "),a=a.replace(/[:,.!?\[\]]/g,function(a){switch(a){case":":return" COLON";case",":return" COMMA";case".":return" PERIOD";case"!":return" EXCLAMATION_POINT";case"?":return" QUESTION_MARK";case"[":return"LEFT_BRACKET ";case"]":return" RIGHT_BRACKET"}});for(var b=a.split(" ");b.length>0;){var c=b.shift();if(this.dictionary[c])this.tokens.push(new Horatio.Token(this.dictionary[c],c));else{for(var d=0,e=c;!this.dictionary[c]&&6>d;)c=c+" "+b[d],this.dictionary[c]&&(this.tokens.push(new Horatio.Token(this.dictionary[c],c)),b.splice(0,d+1)),d+=1;6===d&&this.tokens.push(new Horatio.Token(43,e))}}},buildDictionary:function(){var a=this,b=Horatio.Wordlists;b.characters.forEach(function(b){a.dictionary[b]=10}),b.articles.forEach(function(b){a.dictionary[b]=11}),b.be.forEach(function(b){a.dictionary[b]=12}),b.act.forEach(function(b){a.dictionary[b]=13}),b.scene.forEach(function(b){a.dictionary[b]=14}),b.enter.forEach(function(b){a.dictionary[b]=15}),b.exit.forEach(function(b){a.dictionary[b]=16}),b.exeunt.forEach(function(b){a.dictionary[b]=17}),b.input_integer.forEach(function(b){a.dictionary[b]=21}),b.input_char.forEach(function(b){a.dictionary[b]=22}),b.output_integer.forEach(function(b){a.dictionary[b]=24}),b.output_char.forEach(function(b){a.dictionary[b]=25}),b.imperatives.forEach(function(b){a.dictionary[b]=30}),b.to.forEach(function(b){a.dictionary[b]=31}),b.return.forEach(function(b){a.dictionary[b]=32}),b.positive_comparatives.forEach(function(b){a.dictionary[b]=40}),b.negative_comparatives.forEach(function(b){a.dictionary[b]=41}),b.as.forEach(function(b){a.dictionary[b]=42}),b.not.forEach(function(b){a.dictionary[b]=43}),b.than.forEach(function(b){a.dictionary[b]=44}),b.if_so.forEach(function(b){a.dictionary[b]=45}),b.be_comparatives.forEach(function(b){a.dictionary[b]=46}),b.unary_operators.forEach(function(b){a.dictionary[b]=50}),b.arithmetic_operators.forEach(function(b){a.dictionary[b]=51}),b.remember.forEach(function(b){a.dictionary[b]=60}),b.recall.forEach(function(b){a.dictionary[b]=61}),b.first_person_pronouns.forEach(function(b){a.dictionary[b]=70}),b.second_person_pronouns.forEach(function(b){a.dictionary[b]=71}),b.positive_adjectives.forEach(function(b){a.dictionary[b]=72}),b.neutral_adjectives.forEach(function(b){a.dictionary[b]=73}),b.negative_adjectives.forEach(function(b){a.dictionary[b]=74}),b.positive_nouns.forEach(function(b){a.dictionary[b]=75}),b.neutral_nouns.forEach(function(b){a.dictionary[b]=76}),b.negative_nouns.forEach(function(b){a.dictionary[b]=77}),b.roman_numerals.forEach(function(b){a.dictionary[b]=78}),b.colon.forEach(function(b){a.dictionary[b]=90}),b.comma.forEach(function(b){a.dictionary[b]=91}),b.period.forEach(function(b){a.dictionary[b]=92}),b.exclamation_point.forEach(function(b){a.dictionary[b]=93}),b.question_mark.forEach(function(b){a.dictionary[b]=94}),b.ampersand.forEach(function(b){a.dictionary[b]=95}),b.and.forEach(function(b){a.dictionary[b]=96}),b.left_bracket.forEach(function(b){a.dictionary[b]=97}),b.right_bracket.forEach(function(b){a.dictionary[b]=98})}},Horatio.Parser=function(a){this.tokenizer=new Horatio.Tokenizer(a),this.currentToken=null},Horatio.Parser.prototype={accept:function(a){if(this.currentToken.kind!==a)throw new Error("Syntax Error - Unexpected Token: "+JSON.stringify(this.currentToken));this.currentToken=this.tokenizer.nextToken()},acceptIt:function(){this.currentToken=this.tokenizer.nextToken()},parse:function(){this.currentToken=this.tokenizer.nextToken();var a=this.parseProgram();if(-1!==this.currentToken)throw new Error("Syntax Error - unexpected end of program");return a},parseProgram:function(){var a=this.parseComment();this.accept(Horatio.Token.PERIOD);for(var b=[this.parseDeclaration()];this.currentToken.kind===Horatio.Token.CHARACTER;)b.push(this.parseDeclaration());for(var c=[this.parsePart()];this.currentToken.kind===Horatio.Token.ACT;)c.push(this.parsePart());return new Horatio.AST.Program(a,b,c)},parseComment:function(){for(var a="";this.currentToken.kind!==Horatio.Token.PERIOD;)a+=this.currentToken.sequence+" ",this.acceptIt();return new Horatio.AST.Comment(a.trim())},parseDeclaration:function(){var a=new Horatio.AST.Character(this.currentToken.sequence);this.accept(Horatio.Token.CHARACTER),this.accept(Horatio.Token.COMMA);var b=this.parseComment();return this.accept(Horatio.Token.PERIOD),new Horatio.AST.Declaration(a,b)},parsePart:function(){this.accept(Horatio.Token.ACT);var a=new Horatio.AST.Numeral(this.currentToken.sequence);this.accept(Horatio.Token.ROMAN_NUMERAL),this.accept(Horatio.Token.COLON);var b=this.parseComment();this.accept(Horatio.Token.PERIOD);for(var c=[this.parseSubPart()];this.currentToken.kind===Horatio.Token.SCENE;)c.push(this.parseSubPart());return new Horatio.AST.Part(a,b,c)},parseSubPart:function(){this.accept(Horatio.Token.SCENE);var a=new Horatio.AST.Numeral(this.currentToken.sequence);this.accept(Horatio.Token.ROMAN_NUMERAL),this.accept(Horatio.Token.COLON);var b=this.parseComment();this.accept(Horatio.Token.PERIOD);var c=this.parseStage();return new Horatio.AST.Subpart(a,b,c)},parseStage:function(){var a,b;this.currentToken.kind===Horatio.Token.LEFT_BRACKET&&(a=this.parsePresence());var c=this.parseDialogue();return this.currentToken.kind===Horatio.Token.LEFT_BRACKET&&(b=this.parsePresence()),new Horatio.AST.Stage(c,a,b)},parsePresence:function(){this.accept(Horatio.Token.LEFT_BRACKET);var a,b,c;switch(this.currentToken.kind){case Horatio.Token.ENTER:this.acceptIt(),a=new Horatio.AST.Character(this.currentToken.sequence),b=null,this.accept(Horatio.Token.CHARACTER),this.currentToken.kind===Horatio.Token.AMPERSAND&&(this.acceptIt(),b=new Horatio.AST.Character(this.currentToken.sequence),this.accept(Horatio.Token.CHARACTER)),c=new Horatio.AST.Enter(a,b);break;case Horatio.Token.EXIT:this.acceptIt();var d=new Horatio.AST.Character(this.currentToken.sequence);this.accept(Horatio.Token.CHARACTER),c=new Horatio.AST.Exit(d);break;case Horatio.Token.EXEUNT:this.acceptIt(),this.currentToken.kind===Horatio.Token.CHARACTER?(a=new Horatio.AST.Character(this.currentToken.sequence),this.acceptIt(),this.accept(Horatio.Token.AMPERSAND),b=new Horatio.AST.Character(this.currentToken.sequence),this.accept(Horatio.Token.CHARACTER),c=new Horatio.AST.Exeunt(a,b)):c=new Horatio.AST.Exeunt}return this.accept(Horatio.Token.RIGHT_BRACKET),c},parseDialogue:function(){for(var a=[this.parseLine()];this.currentToken.kind===Horatio.Token.CHARACTER;)a.push(this.parseLine());return new Horatio.AST.Dialogue(a)},parseLine:function(){function a(a){switch(a){case Horatio.Token.BE:case Horatio.Token.BE_COMPARATIVE:case Horatio.Token.IF_SO:case Horatio.Token.IMPERATIVE:case Horatio.Token.INPUT_INTEGER:case Horatio.Token.INPUT_CHAR:case Horatio.Token.OUTPUT_INTEGER:case Horatio.Token.OUTPUT_CHAR:case Horatio.Token.REMEMBER:case Horatio.Token.RECALL:return!0;default:return!1}}var b=new Horatio.AST.Character(this.currentToken.sequence);this.accept(Horatio.Token.CHARACTER),this.accept(Horatio.Token.COLON);for(var c=[this.parseSentence()];a(this.currentToken.kind);)c.push(this.parseSentence());return new Horatio.AST.Line(b,c)},parseSentence:function(){var a;switch(this.currentToken.kind){case Horatio.Token.BE:a=this.parseAssignment(),this.accept(Horatio.Token.PERIOD);break;case Horatio.Token.BE_COMPARATIVE:a=this.parseQuestion(),this.accept(Horatio.Token.QUESTION_MARK);break;case Horatio.Token.IF_SO:a=this.parseResponse(),this.accept(Horatio.Token.PERIOD);break;case Horatio.Token.IMPERATIVE:a=this.parseGoto(),this.accept(Horatio.Token.PERIOD);break;case Horatio.Token.INPUT_INTEGER:case Horatio.Token.INPUT_CHAR:a=this.parseInput(),this.accept(Horatio.Token.EXCLAMATION_POINT);break;case Horatio.Token.OUTPUT_INTEGER:case Horatio.Token.OUTPUT_CHAR:a=this.parseOutput(),this.accept(Horatio.Token.EXCLAMATION_POINT);break;case Horatio.Token.REMEMBER:a=this.parseRemember(),this.accept(Horatio.Token.EXCLAMATION_POINT);break;case Horatio.Token.RECALL:a=this.parseRecall(),this.accept(Horatio.Token.EXCLAMATION_POINT)}return a},parseAssignment:function(){this.accept(Horatio.Token.BE),this.currentToken.kind===Horatio.Token.AS&&(this.acceptIt(),this.parseAdjective(),this.accept(Horatio.Token.AS));var a=this.parseValue();return new Horatio.AST.AssignmentSentence(a)},parseValue:function(){var a,b;switch(this.currentToken.kind){case Horatio.Token.UNARY_OPERATOR:a=this.parseUnaryOperation();break;case Horatio.Token.ARITHMETIC_OPERATOR:a=this.parseArithmeticOperation();break;case Horatio.Token.POSITIVE_NOUN:case Horatio.Token.NEUTRAL_NOUN:case Horatio.Token.NEGATIVE_NOUN:case Horatio.Token.ARTICLE:a=this.parseConstant();break;case Horatio.Token.FIRST_PERSON_PRONOUN:b=new Horatio.AST.FirstPersonPronoun(this.currentToken.sequence),a=new Horatio.AST.PronounValue(b),this.acceptIt();break;case Horatio.Token.SECOND_PERSON_PRONOUN:b=new Horatio.AST.SecondPersonPronoun(this.currentToken.sequence),a=new Horatio.AST.PronounValue(b),this.acceptIt()}return a},parseUnaryOperation:function(){var a=new Horatio.AST.UnaryOperator(this.currentToken.sequence);this.accept(Horatio.Token.UNARY_OPERATOR);var b=this.parseValue();return new Horatio.AST.UnaryOperationValue(a,b)},parseArithmeticOperation:function(){var a=new Horatio.AST.ArithmeticOperator(this.currentToken.sequence);this.accept(Horatio.Token.ARITHMETIC_OPERATOR);var b=this.parseValue();this.accept(Horatio.Token.AND);var c=this.parseValue();return new Horatio.AST.ArithmeticOperationValue(a,b,c)},parseConstant:function(){switch(this.currentToken.kind===Horatio.Token.ARTICLE&&this.acceptIt(),this.currentToken.kind){case Horatio.Token.POSITIVE_ADJECTIVE:case Horatio.Token.POSITIVE_NOUN:return this.parsePositiveConstant();case Horatio.Token.NEGATIVE_ADJECTIVE:case Horatio.Token.NEGATIVE_NOUN:return this.parseNegativeConstant()}},parsePositiveConstant:function(){for(var a,b=[];this.currentToken.kind!==Horatio.Token.POSITIVE_NOUN;)switch(this.currentToken.kind){case Horatio.Token.POSITIVE_ADJECTIVE:a=new Horatio.AST.PositiveAdjective(this.currentToken.sequence),b.push(a),this.acceptIt();break;case Horatio.Token.NEUTRAL_ADJECTIVE:a=new Horatio.AST.NeutralAdjective(this.currentToken.sequence),b.push(a),this.acceptIt()}var c=new Horatio.AST.PositiveNoun(this.currentToken.sequence);return this.accept(Horatio.Token.POSITIVE_NOUN),new Horatio.AST.PositiveConstantValue(c,b)},parseNegativeConstant:function(){for(var a,b=[];this.currentToken.kind!==Horatio.Token.NEGATIVE_NOUN;)switch(this.currentToken.kind){case Horatio.Token.NEGATIVE_ADJECTIVE:a=new Horatio.AST.NegativeAdjective(this.currentToken.sequence),b.push(a),this.acceptIt();break;case Horatio.Token.NEUTRAL_ADJECTIVE:a=new Horatio.AST.NeutralAdjective(this.currentToken.sequence),b.push(a),this.acceptIt()}var c=new Horatio.AST.NegativeNoun(this.currentToken.sequence);return this.accept(Horatio.Token.NEGATIVE_NOUN),new Horatio.AST.NegativeConstantValue(c,b)},parseQuestion:function(){this.accept(Horatio.Token.BE_COMPARATIVE);var a=this.parseComparative(),b=this.parseValue();return new Horatio.AST.QuestionSentence(a,b)},parseComparative:function(){var a,b,c;switch(this.currentToken.kind){case Horatio.Token.POSITIVE_COMPARATIVE:b=new Horatio.AST.PositiveComparative(this.currentToken.sequence),a=new Horatio.AST.GreaterThanComparison(b),this.acceptIt(),this.accept(Horatio.Token.THAN);break;case Horatio.Token.NEGATIVE_COMPARATIVE:b=new Horatio.AST.NegativeComparative(this.currentToken.sequence),a=new Horatio.AST.LesserThanComparison(b),this.acceptIt(),this.accept(Horatio.Token.THAN);break;case Horatio.Token.AS:this.acceptIt(),c=this.parseAdjective(),a=new Horatio.AST.EqualToComparison(c),this.accept(Horatio.Token.AS);break;case Horatio.Token.NOT:this.acceptIt(),b=this.parseComparative(),a=new Horatio.AST.InverseComparison(b)}return a},parseResponse:function(){this.accept(Horatio.Token.IF_SO),this.accept(Horatio.Token.COMMA);var a=this.parseGoto();return new Horatio.AST.ResponseSentence(a)},parseGoto:function(){this.accept(Horatio.Token.IMPERATIVE),this.accept(Horatio.Token.RETURN),this.accept(Horatio.Token.TO),this.accept(Horatio.Token.SCENE);var a=new Horatio.AST.Numeral(this.currentToken.sequence);return this.accept(Horatio.Token.ROMAN_NUMERAL),new Horatio.AST.Goto(a)},parseInput:function(){var a,b=this.currentToken.sequence;switch(this.currentToken.kind){case Horatio.Token.INPUT_INTEGER:a=new Horatio.AST.IntegerInputSentence(b);break;case Horatio.Token.INPUT_CHAR:a=new Horatio.AST.CharInputSentence(b)}return this.acceptIt(),a},parseOutput:function(){var a,b=this.currentToken.sequence;switch(this.currentToken.kind){case Horatio.Token.OUTPUT_INTEGER:a=new Horatio.AST.IntegerOutputSentence(b);break;case Horatio.Token.OUTPUT_CHAR:a=new Horatio.AST.CharOutputSentence(b)}return this.acceptIt(),a},parseRemember:function(){this.accept(Horatio.Token.REMEMBER);var a;switch(this.currentToken.kind){case Horatio.Token.FIRST_PERSON_PRONOUN:a=new Horatio.AST.FirstPersonPronoun(this.currentToken.sequence),this.acceptIt();break;case Horatio.Token.SECOND_PERSON_PRONOUN:a=new Horatio.AST.SecondPersonPronoun(this.currentToken.sequence),this.acceptIt()}return new Horatio.AST.RememberSentence(a)},parseRecall:function(){this.accept(Horatio.Token.RECALL),this.accept(Horatio.Token.COMMA);for(var a="";this.currentToken.kind!==Horatio.Token.EXCLAMATION_POINT;)a+=this.currentToken.sequence+" ",this.acceptIt();return new Horatio.AST.RecallSentence(a.trim())},parseAdjective:function(){switch(this.currentToken.kind){case Horatio.Token.POSITIVE_ADJECTIVE:case Horatio.Token.NEUTRAL_ADJECTIVE:case Horatio.Token.NEGATIVE_ADJECTIVE:this.acceptIt()}}},Horatio.Compiler=function(){},Horatio.Compiler.prototype={compile:function(a){var b=new Horatio.Parser(a),c=b.parse();return c}},Horatio.Checker=function(){Horatio.Visitor.call(this),this.characters={},this.parts={}},Horatio.Checker.prototype=new Horatio.Visitor,Horatio.Checker.prototype.check=function(a){a.visit(this,null)},Horatio.Checker.prototype.declared=function(a){return this.characters.hasOwnProperty(a)},Horatio.Checker.prototype.onStage=function(a){return this.declared(a)&&this.characters[a].on_stage===!0?!0:!1},Horatio.Checker.prototype.toggleStage=function(a){this.declared(a)&&(this.characters[a].on_stage=!this.characters[a].on_stage)},Horatio.Checker.prototype.exeuntStage=function(){for(var a in this.characters)this.characters[a].on_stage=!1},Horatio.Wordlists.act=["Act"],Horatio.Wordlists.scene=["Scene"],Horatio.Wordlists.arithmetic_operators=["the sum of","the difference between","the product of","the quotient between","the remainder of the quotient between"],Horatio.Wordlists.articles=["a","an","the"],Horatio.Wordlists.be=["Thou art","You are","I am"],Horatio.Wordlists.be_comparatives=["Art thou","Are you","Am I"],Horatio.Wordlists.characters=["Achilles","Adonis","Adriana","Aegeon","Aemilia","Agamemnon","Agrippa","Ajax","Alonso","Andromache","Angelo","Antiochus","Antonio","Arthur","Autolycus","Balthazar","Banquo","Beatrice","Benedick","Benvolio","Bianca","Brabantio","Brutus","Capulet","Cassandra","Cassius","Christopher Sly","Cicero","Claudio","Claudius","Cleopatra","Cordelia","Cornelius","Cressida","Cymberline","Demetrius","Desdemona","Dionyza","Doctor Caius","Dogberry","Don John","Don Pedro","Donalbain","Dorcas","Duncan","Egeus","Emilia","Escalus","Falstaff","Fenton","Ferdinand","Ford","Fortinbras","Francisca","Friar John","Friar Laurence","Gertrude","Goneril","Hamlet","Hecate","Hector","Helen","Helena","Hermia","Hermonie","Hippolyta","Horatio","Imogen","Isabella","John of Gaunt","John of Lancaster","Julia","Juliet","Julius Caesar","King Henry","King John","King Lear","King Richard","Lady Capulet","Lady Macbeth","Lady Macduff","Lady Montague","Lennox","Leonato","Luciana","Lucio","Lychorida","Lysander","Macbeth","Macduff","Malcolm","Mariana","Mark Antony","Mercutio","Miranda","Mistress Ford","Mistress Overdone","Mistress Page","Montague","Mopsa","Oberon","Octavia","Octavius Caesar","Olivia","Ophelia","Orlando","Orsino","Othello","Page","Pantino","Paris","Pericles","Pinch","Polonius","Pompeius","Portia","Priam","Prince Henry","Prospero","Proteus","Publius","Puck","Queen Elinor","Regan","Robin","Romeo","Rosalind","Sebastian","Shallow","Shylock","Slender","Solinus","Stephano","Thaisa","The Abbot of Westminster","The Apothecary","The Archbishop of Canterbury","The Duke of Milan","The Duke of Venice","The Ghost","Theseus","Thurio","Timon","Titania","Titus","Troilus","Tybalt","Ulysses","Valentine","Venus","Vincentio","Viola"],Horatio.Wordlists.enter=["Enter"],Horatio.Wordlists.exit=["Exit"],Horatio.Wordlists.exeunt=["Exeunt"],Horatio.Wordlists.first_person=["I","i","me"],Horatio.Wordlists.first_person_possessive=["mine","my"],Horatio.Wordlists.first_person_reflexive=["myself"],Horatio.Wordlists.imperatives=["Let us","let us","We shall","we shall","We must","we must"],Horatio.Wordlists.to=["to"],Horatio.Wordlists.return=["proceed","return"],Horatio.Wordlists.input_integer=["Listen to your heart"],Horatio.Wordlists.input_char=["Open your mind"],Horatio.Wordlists.input=Horatio.Wordlists.input_integer.concat(Horatio.Wordlists.input_char),Horatio.Wordlists.output_integer=["Open your heart"],Horatio.Wordlists.output_char=["Speak your mind"],Horatio.Wordlists.output=Horatio.Wordlists.output_integer.concat(Horatio.Wordlists.output_char),Horatio.Wordlists.as=["as"],Horatio.Wordlists.not=["not"],Horatio.Wordlists.than=["than"],Horatio.Wordlists.if_so=["If so"],Horatio.Wordlists.and=["and"],Horatio.Wordlists.negative_adjectives=["bad","big","cowardly","cursed","damned","dirty","disgusting","distasteful","dusty","evil","fat","fat-kidneyed","fatherless","foul","hairy","half-witted","horrible","horrid","infected","lying","miserable","misused","oozing","rotten","smelly","snotty","sorry","stinking","stuffed","stupid","vile","villainous","worried"],Horatio.Wordlists.negative_comparatives=["punier","smaller","worse"],Horatio.Wordlists.negative_nouns=["Hell","Microsoft","bastard","beggar","blister","codpiece","coward","curse","death","devil","draught","famine","flirt-gill","goat","hate","hog","hound","leech","lie","pig","plague","starvation","toad","war","wolf"],Horatio.Wordlists.neutral_adjectives=["big","black","blue","bluest","bottomless","furry","green","hard","huge","large","little","normal","old","purple","red","rural","small","tiny","white","yellow"],Horatio.Wordlists.neutral_nouns=["animal","aunt","brother","cat","chihuahua","cousin","cow","daughter","door","face","father","fellow","granddaughter","grandfather","grandmother","grandson","hair","hamster","horse","lamp","lantern","mistletoe","moon","morning","mother","nephew","niece","nose","purse","road","roman","sister","sky","son","squirrel","stone wall","thing","town","tree","uncle","wind"],Horatio.Wordlists.nothing=["nothing","zero"],Horatio.Wordlists.positive_adjectives=["amazing","beautiful","blossoming","bold","black","brave","charming","clearest","cunning","cute","delicious","embroidered","fair","fine","gentle","golden","good","handsome","happy","healthy","honest","little","lovely","loving","mighty","noble","old","peaceful","pretty","prompt","proud","reddest","rich","rural","smooth","sunny","sweet","sweetest","trustworthy","tiny","warm"],Horatio.Wordlists.positive_comparatives=["better","bigger","fresher","friendlier","nicer","jollier"],Horatio.Wordlists.positive_nouns=["Heaven","King","Lord","angel","flower","happiness","joy","plum","summer's day","hero","rose","kingdom","pony","cat"],Horatio.Wordlists.first_person_pronouns=["myself","me"],Horatio.Wordlists.second_person_pronouns=["you","yourself","thy","thee","thou"],Horatio.Wordlists.roman_numerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX"],Horatio.Wordlists.second_person=["thee","thou","you"],Horatio.Wordlists.second_person_possessive=["thine","thy","your"],Horatio.Wordlists.second_person_reflexive=["thyself","yourself"],Horatio.Wordlists.remember=["Remember"],Horatio.Wordlists.recall=["Recall"],Horatio.Wordlists.colon=["COLON"],Horatio.Wordlists.comma=["COMMA"],Horatio.Wordlists.period=["PERIOD"],Horatio.Wordlists.exclamation_point=["EXCLAMATION_POINT"],Horatio.Wordlists.question_mark=["QUESTION_MARK"],Horatio.Wordlists.ampersand=["&"],Horatio.Wordlists.left_bracket=["LEFT_BRACKET"],Horatio.Wordlists.right_bracket=["RIGHT_BRACKET"],Horatio.Wordlists.third_person_possessive=["his","her","its","their"],Horatio.Wordlists.unary_operators=["the square of","the cube of","the square root of","the factorial of","twice"];