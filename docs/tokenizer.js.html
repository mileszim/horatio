<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/tokenizer.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: src/tokenizer.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * SPL Tokenizer
 * @memberof Horatio
 * @param {string} input - An input SPL program
 * @constructor
 */
Horatio.Tokenizer = function(input) {
  this.tokens = [];
  this.dictionary = {};
  this.buildDictionary();
  this.tokenize(input);
};


Horatio.Tokenizer.prototype = {
  
  /**
   * Get the next token
   * @returns {Horatio.Token|number} - The next token from the input program, or -1 if no remaining tokens.
   */
  nextToken: function() {
    if (this.tokens.length > 0) {
      return this.tokens.shift();
    } else {
      return -1;
    }
  },
  
  
  
  /**
   * Scan and tokenize an input SPL program
   * @param {string} input - The input SPL program
   */
  tokenize: function(input) {
    // strip all newlines/extra whitespace
    input = input.trim().replace(/[\s\n]+/g," ");
    
    // replace terminals
    input = input.replace(/[:,.!?\[\]]/g, function(match) {
      switch(match) {
        case ":": return " COLON";             //break;
        case ",": return " COMMA";             //break;
        case ".": return " PERIOD";            //break;
        case "!": return " EXCLAMATION_POINT"; //break;
        case "?": return " QUESTION_MARK";     //break;
        case "[": return "LEFT_BRACKET ";      //break;
        case "]": return " RIGHT_BRACKET";     //break;
      }
    });
    
    // Split into array by spaces
    var input_array = input.split(" ");
    
    // tokenize
    while (input_array.length > 0) {
      var current = input_array.shift();
      if (this.dictionary[current]) {
        this.tokens.push(new Horatio.Token(this.dictionary[current], current));
      } else {
        
        // check if further appends will find match
        var br = 0;
        var orig = current;
        while (!this.dictionary[current] && br &lt; 6) {
          current = current + " " + input_array[br];
          
          if (this.dictionary[current]) {
            this.tokens.push(new Horatio.Token(this.dictionary[current], current));
            input_array.splice(0,br+1);
          }
          br += 1;
        }
        
        // comment
        if (br===6) this.tokens.push(new Horatio.Token(43, orig));
      }
    }
  },
  
  
  
  /**
   * Builds a hash of words -> byte codes for scanning
   */
  buildDictionary: function() {
    var self = this;
    var wl = Horatio.Wordlists;
    
    wl.characters            .forEach(function(w) { self.dictionary[w] = 10; });
    wl.articles              .forEach(function(w) { self.dictionary[w] = 11; });
    wl.be                    .forEach(function(w) { self.dictionary[w] = 12; });
    wl.act                   .forEach(function(w) { self.dictionary[w] = 13; });
    wl.scene                 .forEach(function(w) { self.dictionary[w] = 14; });
    wl.enter                 .forEach(function(w) { self.dictionary[w] = 15; });
    wl.exit                  .forEach(function(w) { self.dictionary[w] = 16; });
    wl.exeunt                .forEach(function(w) { self.dictionary[w] = 17; });
    
    //wl.input                 .forEach(function(w) { self.dictionary[w] = 20; });
    wl.input_integer         .forEach(function(w) { self.dictionary[w] = 21; });
    wl.input_char            .forEach(function(w) { self.dictionary[w] = 22; });
    //wl.output                .forEach(function(w) { self.dictionary[w] = 23; });
    wl.output_integer        .forEach(function(w) { self.dictionary[w] = 24; });
    wl.output_char           .forEach(function(w) { self.dictionary[w] = 25; });
    
    wl.imperatives           .forEach(function(w) { self.dictionary[w] = 30; });
    wl.to                    .forEach(function(w) { self.dictionary[w] = 31; });
    wl.return                .forEach(function(w) { self.dictionary[w] = 32; });
    
    wl.positive_comparatives .forEach(function(w) { self.dictionary[w] = 40; });
    wl.negative_comparatives .forEach(function(w) { self.dictionary[w] = 41; });
    wl.as                    .forEach(function(w) { self.dictionary[w] = 42; });
    wl.not                   .forEach(function(w) { self.dictionary[w] = 43; });
    wl.than                  .forEach(function(w) { self.dictionary[w] = 44; });
    wl.if_so                 .forEach(function(w) { self.dictionary[w] = 45; });
    wl.be_comparatives       .forEach(function(w) { self.dictionary[w] = 46; });
    
    wl.unary_operators       .forEach(function(w) { self.dictionary[w] = 50; });
    wl.arithmetic_operators  .forEach(function(w) { self.dictionary[w] = 51; });
    
    wl.remember              .forEach(function(w) { self.dictionary[w] = 60; });
    wl.recall                .forEach(function(w) { self.dictionary[w] = 61; });
    
    wl.first_person_pronouns .forEach(function(w) { self.dictionary[w] = 70; });
    wl.second_person_pronouns.forEach(function(w) { self.dictionary[w] = 71; });
    wl.positive_adjectives   .forEach(function(w) { self.dictionary[w] = 72; });
    wl.neutral_adjectives    .forEach(function(w) { self.dictionary[w] = 73; });
    wl.negative_adjectives   .forEach(function(w) { self.dictionary[w] = 74; });
    wl.positive_nouns        .forEach(function(w) { self.dictionary[w] = 75; });
    wl.neutral_nouns         .forEach(function(w) { self.dictionary[w] = 76; });
    wl.negative_nouns        .forEach(function(w) { self.dictionary[w] = 77; });
    wl.roman_numerals        .forEach(function(w) { self.dictionary[w] = 78; });
    
    wl.colon                 .forEach(function(w) { self.dictionary[w] = 90; });
    wl.comma                 .forEach(function(w) { self.dictionary[w] = 91; });
    wl.period                .forEach(function(w) { self.dictionary[w] = 92; });
    wl.exclamation_point     .forEach(function(w) { self.dictionary[w] = 93; });
    wl.question_mark         .forEach(function(w) { self.dictionary[w] = 94; });
    wl.ampersand             .forEach(function(w) { self.dictionary[w] = 95; });
    wl.and                   .forEach(function(w) { self.dictionary[w] = 96; });
    wl.left_bracket          .forEach(function(w) { self.dictionary[w] = 97; });
    wl.right_bracket         .forEach(function(w) { self.dictionary[w] = 98; });
  }

  
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Horatio.AST.ArithmeticOperationValue.html">ArithmeticOperationValue</a></li><li><a href="Horatio.AST.ArithmeticOperator.html">ArithmeticOperator</a></li><li><a href="Horatio.AST.AssignmentSentence.html">AssignmentSentence</a></li><li><a href="Horatio.AST.Character.html">Character</a></li><li><a href="Horatio.AST.CharInputSentence.html">CharInputSentence</a></li><li><a href="Horatio.AST.CharOutputSentence.html">CharOutputSentence</a></li><li><a href="Horatio.AST.Comment.html">Comment</a></li><li><a href="Horatio.AST.Declaration.html">Declaration</a></li><li><a href="Horatio.AST.Dialogue.html">Dialogue</a></li><li><a href="Horatio.AST.Enter.html">Enter</a></li><li><a href="Horatio.AST.EqualToComparison.html">EqualToComparison</a></li><li><a href="Horatio.AST.Exeunt.html">Exeunt</a></li><li><a href="Horatio.AST.Exit.html">Exit</a></li><li><a href="Horatio.AST.FirstPersonPronoun.html">FirstPersonPronoun</a></li><li><a href="Horatio.AST.Goto.html">Goto</a></li><li><a href="Horatio.AST.GotoSentence.html">GotoSentence</a></li><li><a href="Horatio.AST.GreaterThanComparison.html">GreaterThanComparison</a></li><li><a href="Horatio.AST.IntegerInputSentence.html">IntegerInputSentence</a></li><li><a href="Horatio.AST.IntegerOutputSentence.html">IntegerOutputSentence</a></li><li><a href="Horatio.AST.InverseComparison.html">InverseComparison</a></li><li><a href="Horatio.AST.LesserThanComparison.html">LesserThanComparison</a></li><li><a href="Horatio.AST.Line.html">Line</a></li><li><a href="Horatio.AST.NegativeAdjective.html">NegativeAdjective</a></li><li><a href="Horatio.AST.NegativeComparative.html">NegativeComparative</a></li><li><a href="Horatio.AST.NegativeConstantValue.html">NegativeConstantValue</a></li><li><a href="Horatio.AST.NegativeNoun.html">NegativeNoun</a></li><li><a href="Horatio.AST.NeutralAdjective.html">NeutralAdjective</a></li><li><a href="Horatio.AST.NeutralNoun.html">NeutralNoun</a></li><li><a href="Horatio.AST.Numeral.html">Numeral</a></li><li><a href="Horatio.AST.Part.html">Part</a></li><li><a href="Horatio.AST.PositiveAdjective.html">PositiveAdjective</a></li><li><a href="Horatio.AST.PositiveComparative.html">PositiveComparative</a></li><li><a href="Horatio.AST.PositiveConstantValue.html">PositiveConstantValue</a></li><li><a href="Horatio.AST.PositiveNoun.html">PositiveNoun</a></li><li><a href="Horatio.AST.Program.html">Program</a></li><li><a href="Horatio.AST.PronounValue.html">PronounValue</a></li><li><a href="Horatio.AST.QuestionSentence.html">QuestionSentence</a></li><li><a href="Horatio.AST.RecallSentence.html">RecallSentence</a></li><li><a href="Horatio.AST.RememberSentence.html">RememberSentence</a></li><li><a href="Horatio.AST.ResponseSentence.html">ResponseSentence</a></li><li><a href="Horatio.AST.SecondPersonPronoun.html">SecondPersonPronoun</a></li><li><a href="Horatio.AST.Stage.html">Stage</a></li><li><a href="Horatio.AST.Subpart.html">Subpart</a></li><li><a href="Horatio.AST.UnaryOperationValue.html">UnaryOperationValue</a></li><li><a href="Horatio.AST.UnaryOperator.html">UnaryOperator</a></li><li><a href="Horatio.Compiler.html">Compiler</a></li><li><a href="Horatio.Parser.html">Parser</a></li><li><a href="Horatio.Token.html">Token</a></li><li><a href="Horatio.Tokenizer.html">Tokenizer</a></li></ul><h3>Namespaces</h3><ul><li><a href="Horatio.html">Horatio</a></li><li><a href="Horatio.AST.html">AST</a></li><li><a href="Horatio.Wordlists.html">Wordlists</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Wed Mar 19 2014 11:22:42 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
